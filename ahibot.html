<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahi Bot (Yamak) - Bilgi KÃ¼tÃ¼phanesi</title>
    <style>
        :root { --primary: #3b82f6; --bg-deep: #0f172a; --card-bg: #1e293b; --text-white: #f8fafc; --text-dim: #94a3b8; --bot-bubble: #334155; --user-bubble: #2563eb; --accent: #f59e0b; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg-deep); height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; color: var(--text-white); overflow: hidden; }
        
        .main-wrapper { position: relative; width: 600px; display: flex; flex-direction: column; gap: 12px; }
        .back-link { align-self: flex-start; background: rgba(255,255,255,0.05); color: white; padding: 10px 20px; border-radius: 12px; text-decoration: none; font-size: 13px; font-weight: 600; border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; }
        .back-link:hover { background: #ef4444; border-color: #ef4444; }

        .chat-app { width: 100%; height: 850px; max-height: 90vh; background: var(--card-bg); border-radius: 28px; display: flex; flex-direction: column; box-shadow: 0 20px 60px rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.05); }
        .header { padding: 18px 25px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: space-between; }
        
        .btn-group { display: flex; gap: 8px; }
        .nav-btn { padding: 10px 16px; border-radius: 12px; cursor: pointer; font-size: 12px; font-weight: 700; border: 1px solid rgba(255,255,255,0.1); color: white; background: rgba(255,255,255,0.05); transition: 0.2s; }
        .btn-library { color: var(--accent); border-color: rgba(245, 158, 11, 0.3); }
        .btn-teach { color: #10b981; border-color: rgba(16, 185, 129, 0.3); }

        .chat-view { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .msg { max-width: 85%; padding: 14px 18px; border-radius: 18px; font-size: 14.5px; line-height: 1.5; }
        .bot-msg { background: var(--bot-bubble); align-self: flex-start; border-bottom-left-radius: 4px; }
        .user-msg { background: var(--user-bubble); align-self: flex-end; border-bottom-right-radius: 4px; }

        .footer { padding: 18px; display: flex; gap: 10px; background: rgba(0,0,0,0.15); border-radius: 0 0 28px 28px; }
        input { flex: 1; background: #0f172a; border: 1px solid rgba(255,255,255,0.1); padding: 14px; border-radius: 12px; color: white; outline: none; }
        
        /* YAN PANEL */
        .side-panel { position: fixed; right: -450px; top: 0; width: 420px; height: 100%; background: #111827; z-index: 10000; transition: 0.4s; padding: 30px; overflow-y: auto; border-left: 3px solid var(--accent); }
        .side-panel.active { right: 0; }
        .category-title { color: var(--accent); font-size: 12px; font-weight: 800; text-transform: uppercase; margin: 20px 0 10px; letter-spacing: 1px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 5px; }
        .question-item { background: rgba(255,255,255,0.03); padding: 12px 15px; border-radius: 10px; margin-bottom: 8px; cursor: pointer; font-size: 13px; line-height: 1.4; border: 1px solid transparent; transition: 0.2s; color: #e2e8f0; }
        .question-item:hover { background: rgba(245, 158, 11, 0.1); border-color: var(--accent); color: white; }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); display: none; justify-content: center; align-items: center; z-index: 9999; }
        .overlay.active { display: flex; }
        .modal-box { background: var(--card-bg); padding: 30px; border-radius: 20px; width: 90%; max-width: 400px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .typing { font-size: 11px; color: var(--text-dim); padding: 5px 25px; display: none; }
    </style>
</head>
<body>

<div class="main-wrapper">
    <a href="oyun.html" class="back-link">â† Geri DÃ¶n</a>
    <div class="chat-app">
        <div class="header">
            <div style="display:flex; align-items:center; gap:12px;">
                <div style="width:45px; height:45px; background:var(--primary); border-radius:12px; display:flex; justify-content:center; align-items:center; font-weight:900; font-size:20px;">ğŸ¤–</div>
                <div><h3 style="font-size:16px;">Ahi Bot (Yamak) </h3><span style="font-size:11px; color:#10b981;">â—Aktif</span></div>
            </div>
            <div class="btn-group">
                <button class="nav-btn btn-library" onclick="togglePanel(true)">Ã–rnek Sualler</button>
                <button class="nav-btn btn-teach" onclick="toggleModal('teachOverlay', true)">+ Ã–ÄŸret</button>
            </div>
        </div>
        <div class="chat-view" id="chatBox">
            <div class="msg bot-msg">Ben Ahi Bot.
Bilgiyi ahlakla, Ã¶ÄŸrenmeyi deÄŸerlerle buluÅŸturan dijital yol arkadaÅŸÄ±nÄ±m.

Burada;
ğŸ“š kÃ¼ltÃ¼rel mirasÄ±mÄ±zÄ±,
ğŸ¤ Ahilik anlayÄ±ÅŸÄ±nÄ±,
ğŸ§  Ã¶ÄŸretici bilgileri ve
ğŸ¯ doÄŸruyu, iyiyi ve faydalÄ±yÄ±
birlikte keÅŸfedeceÄŸiz.

Merak ettiÄŸini sor, Ã¶ÄŸrenmek istediÄŸini yaz.
Ben sana sade, anlaÅŸÄ±lÄ±r ve Ã¶ÄŸretici cevaplar vermek iÃ§in buradayÄ±m.

Haydi, bilgeliÄŸe giden yola birlikte Ã§Ä±kalÄ±m. ğŸŒ¿</div>
        </div>
        <div class="typing" id="typing">Ahi Bot yazÄ±yor...</div>
        <div class="footer">
            <input type="text" id="userInput" placeholder="MesajÄ±nÄ±zÄ± buraya yazÄ±n..." autocomplete="off">
            <button id="sendBtn" onclick="handleSend()" style="background:var(--primary); color:white; border:none; width:50px; border-radius:12px; cursor:pointer; font-size:18px;">â¤</button>
        </div>
    </div>
</div>

<div id="teachOverlay" class="overlay">
    <div class="modal-box">
        <h2 style="margin-bottom:15px; color:#10b981;">Sistemi EÄŸit</h2>
        <input type="text" id="tQ" placeholder="Soru..." style="width:100%; margin-bottom:10px; padding:12px; background:#0f172a; border:1px solid #334155; color:white; border-radius:8px;">
        <input type="text" id="tA" placeholder="Cevap..." style="width:100%; margin-bottom:15px; padding:12px; background:#0f172a; border:1px solid #334155; color:white; border-radius:8px;">
        <button onclick="saveLesson()" style="width:100%; padding:12px; background:#10b981; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:bold;">HafÄ±zaya Al</button>
        <p onclick="toggleModal('teachOverlay', false)" style="margin-top:15px; font-size:12px; cursor:pointer; color:var(--text-dim);">VazgeÃ§</p>
    </div>
</div>

<div id="libraryPanel" class="side-panel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h2 style="color:var(--accent); font-size:18px;">Soru KÃ¼tÃ¼phanesi</h2>
        <span onclick="togglePanel(false)" style="cursor:pointer; font-size:28px;">&times;</span>
    </div>
    <div id="fullLibrary"></div>
</div>
<div id="devAlertModal" class="overlay active">
    <div class="modal-box">
        <div style="font-size: 40px; margin-bottom: 15px;">âš ï¸</div>
        <h2 style="color: var(--primary); margin-bottom: 15px;">Sistem Bildirimi</h2>
        <p style="color: var(--text-dim); line-height: 1.6; font-size: 14px; margin-bottom: 25px;">
            Ahi Bot ÅŸu anda <strong>GeliÅŸtirme (Beta)</strong> aÅŸamasÄ±ndadÄ±r. <br><br>
            Soru kÃ¼tÃ¼phanesi ve Ã¶ÄŸrenme fonksiyonlarÄ± aktif olmakla birlikte, bazÄ± yanÄ±tlar test sÃ¼recindedir. Sisteme giriÅŸ yaparak tÃ¼m Ã¶zellikleri kullanmaya baÅŸlayabilirsiniz.
        </p>
        <button onclick="closeWelcomeModal()" style="width:100%; padding:15px; background:var(--primary); border:none; color:white; border-radius:12px; font-weight:bold; cursor:pointer; transition: 0.3s;">
            AnladÄ±m, BaÅŸlat
        </button>
    </div>
</div>
<script>
    const chatBox = document.getElementById('chatBox');
    const userInput = document.getElementById('userInput');
    
    // DEV KÃœTÃœPHANE - TAM CÃœMLELER
    const categories = {
        "GÃœNLÃœK SOHBET": [
            { q: "Merhaba, selam!", a: "Selamlar! Ben Ahi Bot. Size nasÄ±l yardÄ±mcÄ± olabilirim?" },
            { q: "NasÄ±lsÄ±n, nasÄ±l gidiyor?", a: "Ã‡ok iyiyim, teÅŸekkÃ¼r ederim! Sizinle bilgi paylaÅŸmak iÃ§in sabÄ±rsÄ±zlanÄ±yorum." },
            { q: "Sen kimsin ve gÃ¶revin nedir?", a: "Ben Ahi Bot; Tasavvuf kÃ¼ltÃ¼rÃ¼ ve kadim Satranc-Ä± Urefa oyunu Ã¼zerine uzmanlaÅŸmÄ±ÅŸ dijital bir asistanÄ±m." },
            { q: "Neler yapabiliyorsun?", a: "Sana Satranc-Ä± Urefa'nÄ±n sÄ±rlarÄ±nÄ± anlatabilirim, manevi kavramlarÄ± aÃ§Ä±klayabilirim veya senin Ã¶ÄŸrettiÄŸin bilgileri hafÄ±zama alabilirim." },
            { q: "TeÅŸekkÃ¼r ederim, saÄŸ ol.", a: "Rica ederim, ne zaman istersen buradayÄ±m! BaÅŸka bir sorun var mÄ±?" }
        ],
        "SATRANC-I UREFA (TEMEL)": [
            { q: "Satranc-Ä± Urefa ne anlama gelir?", a: "â€œAriflerin satrancÄ±â€ demektir. Arif, hakikati kavrayan kiÅŸi anlamÄ±na gelir. Oyun tasavvufÃ® bir Ã¶ÄŸreti aracÄ±dÄ±r." },
            { q: "Oyunun tasavvufÃ® baÄŸlamda geliÅŸtirilmesi neyi ifade eder?", a: "Oyunun sadece eÄŸlence iÃ§in deÄŸil, manevi geliÅŸim ve ahlaki deÄŸerleri Ã¶ÄŸretmek iÃ§in tasarlandÄ±ÄŸÄ±nÄ± gÃ¶sterir." },
            { q: "Satranc-Ä± Urefaâ€™nÄ±n kÃ¶keni hangi Ã¼lkeye dayandÄ±rÄ±lÄ±r?", a: "BazÄ± kaynaklar oyunun kÃ¶kenini Hindistanâ€™a dayandÄ±rÄ±r; ancak tasavvuf Ã§evrelerinde Ä°bnÃ¼â€™l-ArabÃ® ile baÄŸlantÄ±lÄ±dÄ±r." },
            { q: "Muhyiddin Ä°bnÃ¼â€™l-ArabÃ® ile oyunun iliÅŸkisi nedir?", a: "BazÄ± kaynaklar oyunun, Ã¶ÄŸrencilerine tasavvufÃ® Ã¶ÄŸretiyi anlatmak iÃ§in Ä°bnÃ¼â€™l-ArabÃ® tarafÄ±ndan geliÅŸtirilmiÅŸ olabileceÄŸini sÃ¶yler." },
            { q: "Oyunun tarihÃ® kÃ¶keni neden net deÄŸildir?", a: "Kaynaklar sÄ±nÄ±rlÄ± ve bazen Ã§eliÅŸkilidir; bu yÃ¼zden kesin tarih ve mucit konusunda gÃ¶rÃ¼ÅŸ birliÄŸi yoktur." },
            { q: "Oyun tahtasÄ± kaÃ§ kareden oluÅŸur ve neyi simgeler?", a: "101 kareden oluÅŸur; bu sayÄ±, tasavvufÃ® yolculuktaki manevi basamaklarÄ± ve ilerlemeyi simgeler." }
        ],
        "KAVRAMLAR VE SEMBOLLER": [
            { q: "Oyundaki tilkiler neyi temsil eder?", a: "Tilkiler; kin, haset, kibir gibi kÃ¶tÃ¼ huylarÄ± ve oyuncunun manevi olarak gerilemesini temsil eder." },
            { q: "Oyundaki atlar neyi temsil eder?", a: "Atlar; sevgi, merhamet ve iyi ahlak gibi deÄŸerleri ve oyuncunun manevi yÃ¼kseliÅŸini temsil eder." },
            { q: "â€œVisÃ¢lâ€ oyunda neyi temsil eder?", a: "Hakikate ulaÅŸmayÄ±, manevi olgunluÄŸa ve Allah'a kavuÅŸma noktasÄ±na eriÅŸmeyi temsil eder." },
            { q: "Oyunda ilerleme nasÄ±l saÄŸlanÄ±r?", a: "Oyuncular zar atarak kareler Ã¼zerinde ilerler, karÅŸÄ±laÅŸtÄ±klarÄ± kavramlara gÃ¶re (at veya tilki) yol alÄ±r veya geri giderler." },
            { q: "Satranc-Ä± Urefa klasik satranÃ§tan nasÄ±l farklÄ±dÄ±r?", a: "Strateji ve savaÅŸ oyunu olmaktan Ã§ok, manevi bir seyr-Ã¼ sÃ¼luk (yolculuk) ve ahlak eÄŸitimi aracÄ±dÄ±r." }
        ],
        "KÃœLTÃœREL Ã–NEM": [
            { q: "Modern toplumda oyunun kÃ¼ltÃ¼rel Ã¶nemi nedir?", a: "Tasavvuf kÃ¼ltÃ¼rÃ¼nÃ¼ yaÅŸatÄ±r, manevi Ã¶ÄŸretileri kuÅŸaktan kuÅŸaÄŸa aktarÄ±r ve kÃ¼ltÃ¼rel mirasÄ±n bir parÃ§asÄ±dÄ±r." },
            { q: "EÄŸitimde oyunun hangi yÃ¶nleri Ã¶ne Ã§Ä±kar?", a: "Kelime Ã¶ÄŸretimi, ahlaki deÄŸerler eÄŸitimi ve manevi farkÄ±ndalÄ±k kazandÄ±rma yÃ¶nleri Ã¶ne Ã§Ä±kar." },
            { q: "Oyun gÃ¼nÃ¼mÃ¼zde hangi alanlarda kullanÄ±lmÄ±ÅŸtÄ±r?", a: "EÄŸitim, kÃ¼ltÃ¼rel etkinlikler ve Ã¶zellikle TRT'nin tarihi dizilerinde bir Ã¶ÄŸreti aracÄ± olarak kullanÄ±lmÄ±ÅŸtÄ±r." }
        ]
    };

    let learnedData = JSON.parse(localStorage.getItem('ahi_v7_final')) || [];

    function toggleModal(id, show) { document.getElementById(id).classList.toggle('active', show); }
    function togglePanel(show) { document.getElementById('libraryPanel').classList.toggle('active', show); }

    // KÃœTÃœPHANEYÄ° OLUÅTUR
    function initLibrary() {
        const libDiv = document.getElementById('fullLibrary');
        for (let cat in categories) {
            const title = document.createElement('div');
            title.className = 'category-title';
            title.innerText = cat;
            libDiv.appendChild(title);
            categories[cat].forEach(item => {
                const qDiv = document.createElement('div');
                qDiv.className = 'question-item';
                qDiv.innerText = item.q;
                qDiv.onclick = () => { handleSend(item.q); togglePanel(false); };
                libDiv.appendChild(qDiv);
            });
        }
    }
    initLibrary();

    function saveLesson() {
        const q = document.getElementById('tQ').value.trim();
        const a = document.getElementById('tA').value.trim();
        if(q && a) {
            learnedData.push({ q, a });
            localStorage.setItem('ahi_v7_final', JSON.stringify(learnedData));
            toggleModal('teachOverlay', false);
            handleSend(q);
            document.getElementById('tQ').value = ""; document.getElementById('tA').value = "";
        }
    }

    function addMessage(text, type) {
        const d = document.createElement('div');
        d.className = `msg ${type}`;
        d.innerText = text;
        chatBox.appendChild(d);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function handleSend(manualText = null) {
        const text = manualText || userInput.value.trim();
        if(!text) return;

        addMessage(text, 'user-msg');
        userInput.value = "";
        document.getElementById('typing').style.display = 'block';

        setTimeout(() => {
            document.getElementById('typing').style.display = 'none';
            addMessage(findResponse(text), 'bot-msg');
        }, 600);
    }

    function findResponse(input) {
        const t = input.toLowerCase();

        // 1. KullanÄ±cÄ± Ã–ÄŸrettikleri
        const userMatch = learnedData.find(i => t.includes(i.q.toLowerCase()) || i.q.toLowerCase().includes(t));
        if(userMatch) return userMatch.a;

        // 2. Ana KÃ¼tÃ¼phane (Derin Tarama)
        for(let cat in categories) {
            const match = categories[cat].find(i => {
                const qLower = i.q.toLowerCase();
                return t.includes(qLower) || qLower.includes(t) || 
                       (t.length > 4 && qLower.includes(t.substring(0, 5)));
            });
            if(match) return match.a;
        }

        // 3. Ã‡ok basit selamlaÅŸma fix
        if(t.includes("merhaba") || t.includes("selam")) return "Selam! Ben Ahi Bot. Size nasÄ±l yardÄ±mcÄ± olabilirim?";
        if(t.includes("naber") || t.includes("nasÄ±lsÄ±n")) return "Ä°yiyim, teÅŸekkÃ¼r ederim! Sizinle sohbet etmek harika.";

        return "Bunu henÃ¼z Ã¶ÄŸrenmedim. Ama yan taraftaki Soru Havuzu'ndan bir soru seÃ§ebilir veya '+ Ã–ÄŸret' ile bana Ã¶ÄŸretebilirsin!";
    }

    userInput.onkeypress = (e) => { if(e.key === 'Enter') handleSend(); };
  
  // AÃ§Ä±lÄ±ÅŸ uyarÄ±sÄ±nÄ± kapatan fonksiyon
function closeWelcomeModal() {
    document.getElementById('devAlertModal').classList.remove('active');
}
</script>
</body>
</html>
